<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>💕 Test de Historia de Amor</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, 
                #ff9a9e 0%, 
                #fecfef 25%, 
                #fecfef 50%, 
                #ffecd2 75%, 
                #fcb69f 100%
            );
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .floating-heart {
            position: absolute;
            color: rgba(255, 182, 193, 0.6);
            animation: float 6s ease-in-out infinite;
        }
        
        .floating-heart:nth-child(1) { left: 10%; animation-delay: 0s; }
        .floating-heart:nth-child(2) { left: 20%; animation-delay: 2s; }
        .floating-heart:nth-child(3) { left: 30%; animation-delay: 4s; }
        .floating-heart:nth-child(4) { left: 40%; animation-delay: 1s; }
        .floating-heart:nth-child(5) { left: 50%; animation-delay: 3s; }
        .floating-heart:nth-child(6) { left: 60%; animation-delay: 5s; }
        .floating-heart:nth-child(7) { left: 70%; animation-delay: 2.5s; }
        .floating-heart:nth-child(8) { left: 80%; animation-delay: 4.5s; }
        .floating-heart:nth-child(9) { left: 90%; animation-delay: 1.5s; }
        
        @keyframes float {
            0%, 100% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
        
        .container {
            position: relative;
            z-index: 10;
            max-width: 1000px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.1);
            backdrop-filter: blur(20px);
            border: 2px solid rgba(255, 182, 193, 0.3);
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        h1 {
            text-align: center;
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            color: #d63384;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            line-height: 1.2;
        }
        
        .subtitle {
            text-align: center;
            font-family: 'Playfair Display', serif;
            font-size: 1.2rem;
            color: #6c757d;
            margin-bottom: 40px;
            font-style: italic;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: normal;
            line-height: 1.4;
        }
        
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .image-item {
            text-align: center;
            background: linear-gradient(135deg, rgba(255, 182, 193, 0.1), rgba(255, 192, 203, 0.1));
            padding: 25px;
            border-radius: 20px;
            border: 2px solid rgba(255, 182, 193, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .image-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(255, 182, 193, 0.3);
        }
        
        .image-item img {
            max-width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            transition: all 0.3s ease;
        }
        
        .image-item img:hover {
            transform: scale(1.05);
        }
        
        .image-item h3 {
            margin: 15px 0 10px 0;
            color: #d63384;
            font-family: 'Playfair Display', serif;
            font-size: 1.3rem;
        }
        
        .status {
            background: linear-gradient(135deg, #d4edda, #c3e6cb);
            color: #155724;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 25px;
            border: 2px solid #c3e6cb;
            font-weight: 500;
            text-align: center;
        }
        
        .error {
            background: linear-gradient(135deg, #f8d7da, #f5c6cb);
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .test-button {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .test-button:hover {
            background: linear-gradient(135deg, #ff5252, #d63031);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }
        
        .test-button:nth-child(2) {
            background: linear-gradient(135deg, #667eea, #764ba2);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        .test-button:nth-child(2):hover {
            background: linear-gradient(135deg, #5a6fd8, #6a4190);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }
        
        .test-button:nth-child(3) {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.3);
        }
        
        .test-button:nth-child(3):hover {
            background: linear-gradient(135deg, #ee82f9, #f3455a);
            box-shadow: 0 8px 25px rgba(240, 147, 251, 0.4);
        }
        
        .test-button:nth-child(4) {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.3);
        }
        
        .test-button:nth-child(4):hover {
            background: linear-gradient(135deg, #3d8bfe, #00d4fe);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.4);
        }
        
        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .container {
                margin: 0.5rem;
                padding: 1.5rem 1rem;
                max-width: 95%;
            }
            
            h1 {
                font-size: 2rem;
                line-height: 1.1;
                margin-bottom: 0.8rem;
                padding: 0 0.5rem;
            }
            
            .subtitle {
                font-size: 0.9rem;
                line-height: 1.3;
                margin-bottom: 1.5rem;
                padding: 0 0.5rem;
            }
            
            .image-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
                margin-bottom: 2rem;
            }
            
            .image-item {
                padding: 1.5rem;
            }
            
            .image-item img {
                height: 150px;
            }
            
            .image-item h3 {
                font-size: 1.1rem;
            }
            
            .test-button {
                font-size: 0.9rem;
                padding: 12px 20px;
                margin: 8px;
                width: 100%;
                max-width: 280px;
            }
        }
        
        @media (max-width: 576px) {
            .container {
                margin: 0.3rem;
                padding: 1rem 0.8rem;
                max-width: 98%;
            }
            
            h1 {
                font-size: 1.6rem;
                line-height: 1.1;
                padding: 0 0.3rem;
            }
            
            .subtitle {
                font-size: 0.8rem;
                line-height: 1.2;
                padding: 0 0.3rem;
            }
            
            .image-grid {
                gap: 1rem;
            }
            
            .image-item {
                padding: 1rem;
            }
            
            .image-item img {
                height: 120px;
            }
            
            .image-item h3 {
                font-size: 1rem;
            }
            
            .test-button {
                font-size: 0.8rem;
                padding: 10px 16px;
                margin: 5px;
                width: 100%;
                max-width: 250px;
            }
        }
        
        @media (max-width: 400px) {
            .container {
                margin: 0.2rem;
                padding: 0.8rem 0.5rem;
                max-width: 99%;
            }
            
            h1 {
                font-size: 1.4rem;
                line-height: 1.1;
                padding: 0 0.2rem;
            }
            
            .subtitle {
                font-size: 0.75rem;
                line-height: 1.2;
                padding: 0 0.2rem;
            }
            
            .image-item {
                padding: 0.75rem;
            }
            
            .image-item img {
                height: 100px;
            }
            
            .image-item h3 {
                font-size: 0.9rem;
            }
            
            .test-button {
                font-size: 0.75rem;
                padding: 8px 12px;
                margin: 3px;
                width: 100%;
                max-width: 220px;
            }
        }
        
    </style>
</head>
<body>
    <!-- Corazones flotantes -->
    <div class="floating-hearts">
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
        <i class="fas fa-heart floating-heart"></i>
    </div>

    <div class="container">
        <h1>💕 Historia que no deja de escribirse</h1>
        
        <div style="text-align: center; margin: 30px 0;">
            <button id="startStoryBtn" style="background: linear-gradient(135deg, #ff6b9d, #c44569); color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 1.2rem; font-weight: 600; cursor: pointer; box-shadow: 0 8px 25px rgba(255, 107, 157, 0.3); transition: all 0.3s ease; font-family: 'Poppins', sans-serif;">
                Comenzar Historia
            </button>
        </div>
        
        
        
        <!-- Área de prueba de secuencia -->
        <div id="storyTestArea" style="margin-top: 40px; padding: 30px; background: linear-gradient(135deg, rgba(255, 182, 193, 0.1), rgba(255, 192, 203, 0.1)); border-radius: 25px; display: none; border: 2px solid rgba(255, 182, 193, 0.3); backdrop-filter: blur(15px);">
            <!-- Audio para la historia -->
            <audio id="storyAudio" preload="auto" style="display: none;">
                <source src="pista.mp3" type="audio/mpeg">
            </audio>
            
            
            <div id="storyMessage" style="background: rgba(255, 255, 255, 0.95); padding: 50px; border-radius: 30px; margin-bottom: 30px; min-height: 200px; border: 3px solid rgba(255, 182, 193, 0.3); box-shadow: 0 20px 50px rgba(0,0,0,0.2); text-align: center; position: relative; transition: all 0.8s ease;">
                <p id="storyText" style="font-size: 2.2rem; line-height: 1.6; margin: 0; color: #2c3e50; font-family: 'Playfair Display', serif; font-weight: 600; text-shadow: 0 2px 4px rgba(0,0,0,0.1);"></p>
            </div>
            <div id="storyImage" style="text-align: center; display: none; margin-bottom: 30px; position: relative; transition: all 0.8s ease;">
                <img id="storyImageElement" src="" alt="Historia" style="max-width: 100%; height: 600px; object-fit: cover; border-radius: 25px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); border: 4px solid rgba(255, 182, 193, 0.4);">
            </div>
            
            <!-- Botón Siguiente (inicialmente deshabilitado) -->
            <div id="nextButtonContainer" style="text-align: center; margin-top: 30px; display: none;">
                <button id="nextStoryBtn" disabled style="background: linear-gradient(135deg, #6c757d, #495057); color: white; border: none; padding: 15px 30px; border-radius: 25px; font-size: 1.2rem; font-weight: 600; cursor: not-allowed; box-shadow: 0 8px 25px rgba(108, 117, 125, 0.3); transition: all 0.3s ease; font-family: 'Poppins', sans-serif;">
                    Siguiente
                </button>
            </div>
            
        </div>
    </div>

    <script>
        const imagePaths = [
            'images/imagen1.jpg',
            'images/imagen2.jpg', 
            'images/imagen3.jpg',
            'images/imagen4.jpg',
            'images/imagen5.jpg'
        ];
        
        // Datos de la historia (igual que en el proyecto real)
        const storyData = [
            {
                message: "Todo comenzó siendo solo amigos del instituto… Las primeras desveladas, las charlas interminables, las risas compartidas, las bromas que solo nosotros entendíamos: nuestro código 'mijin-mijina'. Siempre hubo apoyo mutuo, pero poco a poco empecé a conocerte de verdad, y algo comenzó a crecer, algo que, aunque las circunstancias no lo permitieran, se fue dando naturalmente.",
                image: "images/imagen1.jpg",
                messageDuration: 23000, // 23 seconds
                imageDuration: 8000    // 8 seconds
            },
            {
                message: "Hay tantas historias que podría contarte, pero el tiempo no alcanzaría. Sin embargo, llegó un momento en que supiste que me gustabas, y desde entonces las bromas sobre eso se hicieron constantes.",
                image: "images/imagen2.jpg",
                messageDuration: 23000,
                imageDuration: 8000
            },
            {
                message: "Y aquel momento que jamás olvidaré… porque fue entonces cuando decidí que no quería ceder, que no podía dejar que esto se escapara.",
                image: "images/imagen3.jpg",
                messageDuration: 23000,
                imageDuration: 8000
            },
            {
                message: "En medio de temores, miedos, desconfianza e inseguridades, tú nunca desististe de esta historia. Y por mi parte, tampoco quería dejarte de lado, como si no me importaras.",
                image: "images/imagen4.jpg",
                messageDuration: 23000,
                imageDuration: 8000
            },
            {
                message: "Después de tantos días con altos y bajos sentimentales, lo más valioso que me has dado es dejar de lado tus inseguridades y, en medio de todo, demostrarme que quieres estar conmigo. Me has regalado cariño, mensajes sinceros y momentos únicos que atesoro profundamente.",
                image: "images/imagen5.jpg",
                messageDuration: 23000,
                imageDuration: 8000
            }
        ];
        
        let currentStoryIndex = 0;
        let storyTimeout = null;
        let storyAudio = null;
        
        // Configurar botón de inicio
        window.addEventListener('load', function() {
            const startBtn = document.getElementById('startStoryBtn');
            if (startBtn) {
                startBtn.addEventListener('click', function() {
                    startBtn.style.display = 'none';
                    startStoryTest();
                });
            }
            
        });
        
        
        
        
        function startStoryTest() {
            console.log('💕 INICIANDO HISTORIA DE AMOR');
            
            // Mostrar área de historia
            const storyTestArea = document.getElementById('storyTestArea');
            if (storyTestArea) {
                storyTestArea.style.display = 'block';
            }
            
            // Inicializar audio como en el proyecto real
            storyAudio = document.getElementById('storyAudio');
            if (storyAudio) {
                storyAudio.addEventListener('ended', onStoryAudioEnded);
                storyAudio.addEventListener('timeupdate', checkAudioTime);
                storyAudio.play().then(() => {
                    console.log('🎵 Audio de historia iniciado');
                    startStorySequence();
                }).catch(error => {
                    console.error('Error playing story audio:', error);
                    // Start sequence anyway
                    startStorySequence();
                });
            } else {
                startStorySequence();
            }
        }
        
        function startStorySequence() {
            if (currentStoryIndex < storyData.length) {
                const currentStory = storyData[currentStoryIndex];
                
                console.log(`💕 HISTORIA ${currentStoryIndex + 1}:`, currentStory);
                
                // 1. MENSAJE GRANDE Y HERMOSO (23 segundos)
                showStoryMessage(currentStory.message, currentStory.messageDuration);
                
                // 2. IMAGEN SOLA DESPUÉS DEL MENSAJE (8 segundos)
                setTimeout(() => {
                    showStoryImage(currentStory.image, currentStory.imageDuration);
                }, currentStory.messageDuration);
                
                // 3. SIGUIENTE HISTORIA
                storyTimeout = setTimeout(() => {
                    currentStoryIndex++;
                    if (currentStoryIndex < storyData.length) {
                        startStorySequence();
                    } else {
                        onStoryCompleted();
                    }
                }, currentStory.messageDuration + currentStory.imageDuration);
            }
        }
        
        function showStoryMessage(message, duration) {
            const storyText = document.getElementById('storyText');
            const storyMessage = document.getElementById('storyMessage');
            
            if (storyText && storyMessage) {
                // Mostrar contenedor del mensaje
                storyMessage.style.display = 'block';
                storyMessage.style.opacity = '1';
                storyMessage.style.transform = 'scale(1)';
                
                // Establecer el mensaje completo
                storyText.textContent = message;
                
                // Efecto de desvanecimiento elegante
                storyText.style.opacity = '0';
                storyText.style.transform = 'translateY(20px)';
                
                // Animar entrada
                setTimeout(() => {
                    storyText.style.transition = 'all 1.5s ease-out';
                    storyText.style.opacity = '1';
                    storyText.style.transform = 'translateY(0)';
                }, 100);
                
                // Desvanecer al final
                setTimeout(() => {
                    storyText.style.transition = 'all 1s ease-in';
                    storyText.style.opacity = '0';
                    storyText.style.transform = 'translateY(-20px)';
                }, duration - 1000);
            }
        }
        
        
        function showStoryImage(imageSrc, duration) {
            console.log('🖼️ MOSTRANDO IMAGEN EN TEST:', imageSrc);
            
            const storyImage = document.getElementById('storyImage');
            const storyImageElement = document.getElementById('storyImageElement');
            const storyMessage = document.getElementById('storyMessage');
            
            if (storyImage && storyImageElement) {
                // 1. OCULTAR MENSAJE
                if (storyMessage) {
                    storyMessage.style.opacity = '0';
                    storyMessage.style.transform = 'scale(0.9)';
                }
                
                // 2. MOSTRAR IMAGEN DESPUÉS DE TRANSICIÓN
                setTimeout(() => {
                    // Ocultar mensaje completamente
                    if (storyMessage) {
                        storyMessage.style.display = 'none';
                    }
                    
                    // Establecer y mostrar imagen
                    storyImageElement.src = imageSrc;
                    storyImage.style.display = 'block';
                    storyImage.style.opacity = '1';
                    storyImage.style.visibility = 'visible';
                    
                    console.log('✅ IMAGEN SOLA VISIBLE EN TEST');
                    
                    // 3. OCULTAR IMAGEN DESPUÉS DEL TIEMPO
                    setTimeout(() => {
                        storyImage.style.display = 'none';
                        console.log('❌ IMAGEN OCULTA EN TEST');
                        
                        // 4. PREPARAR SIGUIENTE MENSAJE
                        if (storyMessage) {
                            storyMessage.style.display = 'block';
                            storyMessage.style.opacity = '1';
                            storyMessage.style.transform = 'scale(1)';
                        }
                    }, duration);
                    
                }, 500); // Transición suave
                
            } else {
                console.error('❌ ELEMENTOS NO ENCONTRADOS EN TEST');
            }
        }
        
        function checkAudioTime() {
            if (storyAudio && storyAudio.currentTime >= 155) { // 2:35 = 155 seconds
                storyAudio.pause();
                storyAudio.currentTime = 0;
                console.log('⏹️ Audio cortado a los 2:35');
            }
        }
        
        function onStoryAudioEnded() {
            // Audio ended, but story might still be playing
            console.log('🎵 Audio de historia terminado');
        }
        
        function onStoryCompleted() {
            console.log('💕 Historia completada con éxito');
            
            // Pausar audio si está reproduciéndose
            if (storyAudio && !storyAudio.paused) {
                storyAudio.pause();
                console.log('⏹️ Audio pausado al completar historia');
            }
            
            // Limpiar timeouts
            if (storyTimeout) {
                clearTimeout(storyTimeout);
                storyTimeout = null;
            }
            
            // Habilitar botón Siguiente
            const nextButtonContainer = document.getElementById('nextButtonContainer');
            const nextStoryBtn = document.getElementById('nextStoryBtn');
            
            if (nextButtonContainer && nextStoryBtn) {
                nextButtonContainer.style.display = 'block';
                nextStoryBtn.disabled = false;
                nextStoryBtn.style.background = 'linear-gradient(135deg, #ff6b9d, #c44569)';
                nextStoryBtn.style.cursor = 'pointer';
                nextStoryBtn.style.boxShadow = '0 8px 25px rgba(255, 107, 157, 0.3)';
                
                // Agregar evento al botón
                nextStoryBtn.addEventListener('click', function() {
                    console.log('🎯 Redirigiendo a continuación de la historia');
                    window.location.href = 'test-video.html';
                });
            }
        }
        
        
    </script>
</body>
</html>
